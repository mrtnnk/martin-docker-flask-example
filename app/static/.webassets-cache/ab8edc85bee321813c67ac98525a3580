Vfunction ImageCtrl($scope,$upload,$http,$log,$timeout){$scope.files=[];$scope.dataUrls=[];$scope.error=false;$scope.alertMessage='';$scope.loading=false;$scope.widthStyle={"width":"0%"};$scope.imageURL='';$scope.onFileSelect=function($files){$scope.files=$files;for(var i=0;i<$files.length;i++){var file=$files[i];var timeStamp=new Date().getTime();var fileName=timeStamp+"_"+file.name;var data={key:"uploads/"+userUUID+"/"+fileName,AWSAccessKeyId:accessKey,acl:'private',policy:policy,signature:signature,"Content-Type":file.type!=''?file.type:'application/octet-stream',filename:"uploads/"+userUUID+"/"+fileName,};var url='https://s3-us-west-2.amazonaws.com/'+imagesBucket;$upload.upload({url:url,method:'POST',data:data,file:file,}).progress(function(evt){$scope.percent=parseInt(100.0*evt.loaded/evt.total);$scope.widthStyle={"width":$scope.percent+"%"};$scope.loading=true;}).success(function(data,status,headers,config){$scope.getImage(fileName);}).error(function(data,status,headers,config){$scope.error=true;$scope.alertMessage="There was an error uploading your photo.";}).then(function(){$scope.loading=false;});}};$scope.getImage=function(fileName){$http.get('/user/'+userUUID+"/photo?file_name="+fileName).success(function(data){$scope.imageURL=data.url;});};$scope.toggleAlert=function(show){$scope.error=show;$scope.alertMessage='';};};
p1
.